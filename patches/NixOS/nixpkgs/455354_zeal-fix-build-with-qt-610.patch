From efb1e653eb55a4bf54d8b25db16dd4b27eae655f Mon Sep 17 00:00:00 2001
From: winston <hey@winston.sh>
Date: Fri, 24 Oct 2025 22:11:58 +0200
Subject: [PATCH] zeal: fix build with qt 6.10

---
 pkgs/by-name/ze/zeal/package.nix  |  2 ++
 pkgs/by-name/ze/zeal/qt6_10.patch | 34 +++++++++++++++++++++++++++++++
 2 files changed, 36 insertions(+)
 create mode 100644 pkgs/by-name/ze/zeal/qt6_10.patch

diff --git a/pkgs/by-name/ze/zeal/package.nix b/pkgs/by-name/ze/zeal/package.nix
index 5c410836489ca..fbcb0ce56783b 100644
--- a/pkgs/by-name/ze/zeal/package.nix
+++ b/pkgs/by-name/ze/zeal/package.nix
@@ -23,6 +23,8 @@ stdenv.mkDerivation (finalAttrs: {
     hash = "sha256-9tlo7+namWNWrWVQNqaOvtK4NQIdb0p8qvFrrbUamOo=";
   };
 
+  patches = [ ./qt6_10.patch ];
+
   nativeBuildInputs = [
     cmake
     extra-cmake-modules
diff --git a/pkgs/by-name/ze/zeal/qt6_10.patch b/pkgs/by-name/ze/zeal/qt6_10.patch
new file mode 100644
index 0000000000000..574c063a3b755
--- /dev/null
+++ b/pkgs/by-name/ze/zeal/qt6_10.patch
@@ -0,0 +1,34 @@
+diff --git a/src/libs/ui/docsetsdialog.cpp b/src/libs/ui/docsetsdialog.cpp
+index 8c9fe63..5c73480 100644
+--- a/src/libs/ui/docsetsdialog.cpp
++++ b/src/libs/ui/docsetsdialog.cpp
+@@ -360,7 +360,7 @@ void DocsetsDialog::downloadCompleted()
+         QTemporaryFile *tmpFile = m_tmpFiles[docsetName];
+         if (!tmpFile) {
+             tmpFile = new QTemporaryFile(QStringLiteral("%1/%2.XXXXXX.tmp").arg(Core::Application::cacheLocation(), docsetName), this);
+-            tmpFile->open();
++            (void)tmpFile->open();
+             m_tmpFiles.insert(docsetName, tmpFile);
+         }
+ 
+@@ -403,7 +403,7 @@ void DocsetsDialog::downloadProgress(qint64 received, qint64 total)
+         QTemporaryFile *tmpFile = m_tmpFiles[docsetName];
+         if (!tmpFile) {
+             tmpFile = new QTemporaryFile(QStringLiteral("%1/%2.XXXXXX.tmp").arg(Core::Application::cacheLocation(), docsetName), this);
+-            tmpFile->open();
++            (void)tmpFile->open();
+             m_tmpFiles.insert(docsetName, tmpFile);
+         }
+ 
+diff --git a/src/libs/ui/qxtglobalshortcut/CMakeLists.txt b/src/libs/ui/qxtglobalshortcut/CMakeLists.txt
+index 476c2f5..f49da88 100644
+--- a/src/libs/ui/qxtglobalshortcut/CMakeLists.txt
++++ b/src/libs/ui/qxtglobalshortcut/CMakeLists.txt
+@@ -42,6 +42,7 @@ elseif(UNIX AND X11_FOUND)
+         find_package(Qt5 COMPONENTS X11Extras REQUIRED)
+         target_link_libraries(QxtGlobalShortcut Qt5::X11Extras)
+     else()
++        find_package(Qt6 REQUIRED COMPONENTS GuiPrivate)
+         target_link_libraries(QxtGlobalShortcut Qt${QT_VERSION_MAJOR}::GuiPrivate)
+     endif()
+ 
