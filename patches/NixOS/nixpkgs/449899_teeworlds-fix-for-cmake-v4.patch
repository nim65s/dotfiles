From aeafd2929e46ff7876b93a1eb1c17a6b2a8b7088 Mon Sep 17 00:00:00 2001
From: Guilhem Saurel <guilhem.saurel@laas.fr>
Date: Wed, 8 Oct 2025 14:28:52 +0200
Subject: [PATCH] teeworlds: fix for CMake v4

Co-authored-by: Luflosi <15217907+Luflosi@users.noreply.github.com>
---
 pkgs/by-name/te/teeworlds/package.nix | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/pkgs/by-name/te/teeworlds/package.nix b/pkgs/by-name/te/teeworlds/package.nix
index 2ed6cf0fb744e5..373e85eaa88964 100644
--- a/pkgs/by-name/te/teeworlds/package.nix
+++ b/pkgs/by-name/te/teeworlds/package.nix
@@ -40,6 +40,12 @@ stdenv.mkDerivation rec {
       url = "https://salsa.debian.org/games-team/teeworlds/-/raw/a6c4b23c1ce73466e6d89bccbede70e61e8c9cba/debian/patches/CVE-2021-43518.patch";
       hash = "sha256-2MmsucaaYjqLgMww1492gNmHmvBJm/NED+VV5pZDnBY=";
     })
+    # Fix for CMake v4
+    # ref. https://github.com/teeworlds/teeworlds/pull/2821 merged upstream
+    (fetchpatch {
+      url = "https://github.com/teeworlds/teeworlds/commit/23f33517b4b0621253862b559f6ed0cd0146bae2.patch";
+      hash = "sha256-RZvq/my7N68Kea26WuzLmyaTNOm5eZL5Gw9SGYpTeoQ=";
+    })
   ];
 
   postPatch = ''
